---
import { type CollectionEntry, getCollection } from "astro:content";
import BaseHtml from "@/layouts/BaseHtml.astro";
import FormattedDate from "@/components/FormattedDate.astro";
import Tags from "@/components/Tags.astro";

export async function getStaticPaths() {
	const posts = await getCollection("blog");
	return posts.map(post => ({
		params: { slug: post.slug },
		props: post,
	}));
}

type Props = CollectionEntry<"blog">;
const post = Astro.props;
const {
	data: { title, description, pubDate, updatedDate, tags },
} = post;
const qqq = await post.render();
const { Content, remarkPluginFrontmatter } = qqq;
// console.log('=====================', remarkPluginFrontmatter);
---

<BaseHtml title={title} description={description}>
	<article class="prose prose-lg dark:prose-invert">
		<header class="text-center">
			<h2 class="my-0">{title}</h2>
			<div class="mt-3">{tags && <Tags tags={tags} withHref={true} />}</div>
			<div class="text-gray-500">
				<FormattedDate date={pubDate} /> - {remarkPluginFrontmatter.minutesRead}
				{
					updatedDate && (
						<div class="italic">
							Last updated on <FormattedDate date={updatedDate} />
						</div>
					)
				}
			</div>
			<hr class="my-4" />
		</header>
		<Content />
	</article>
</BaseHtml>